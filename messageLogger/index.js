(function(i,r,a,s){"use strict";const t=new Map,c=15*60*1e3,o=[];function u(e){if(!e?.id||!e.content||e.author?.bot)return;if(t.has(e.id)){const l=t.get(e.id);clearTimeout(l.timer)}const n=setTimeout(function(){t.delete(e.id)},c);t.set(e.id,{content:e.content,author:e.author?.username??"unknown",timer:n})}var d={onLoad:function(){o.push(r.FluxDispatcher.subscribe("MESSAGE_CREATE",function({message:e}){u(e)})),o.push(r.FluxDispatcher.subscribe("MESSAGE_UPDATE",function({message:e}){e.content&&u(e)})),o.push(r.FluxDispatcher.subscribe("MESSAGE_DELETE",function(e){if(t.has(e.id)){const n=t.get(e.id);a.showToast(`Deleted from ${n.author}: ${n.content}`),clearTimeout(n.timer),t.delete(e.id)}})),s.logger.log("MessageLogger loaded with caching strategy.")},onUnload:function(){for(const e of o)e?.();o.length=0;for(const[e,n]of t)clearTimeout(n.timer);t.clear(),s.logger.log("MessageLogger unloaded and cache cleared.")}};return i.default=d,Object.defineProperty(i,"__esModule",{value:!0}),i})({},vendetta.metro.common,vendetta.ui.toasts,vendetta);
